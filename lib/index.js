!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["calendar-graph-plus"]={})}(this,function(t){"use strict";function o(){return(o=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function S(t,e,...n){var o=[];return function e(n,o){if(null!=n)if("string"==typeof n||"number"==typeof n)o.push(n.toString());else if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t],o);else o.push(n)}(n,o),"function"==typeof t?t({...e,children:o}):{tag:t,props:e,children:o}}const C=864e5;function O(){}function j(){var t=new Date;return t.setHours(0,0,0,0,0),t}const E=["#f4f5f5","#daf6ea","#c7f0df","#82edc0","#0bd07d"];function i(t){return 9<t?""+t:"0"+t}function T(t){var e=t.getFullYear(),n=t.getMonth()+1,t=t.getDate();return`${e}-${i(n)}-`+i(t)}function F({values:t,size:i,space:e,padX:a,padY:n,colorFun:r,onClick:s,onHover:l,monthsPosition:o}){const c=i+2*e;let h="bottom"===o?n/2:n+e;return S("g",null,t.map((n,t)=>{const o=a+t*c+e;return S("g",null,n.map(t=>S("rect",{class:"node",x:o,y:t.day*c+h,rx:"2",ry:"2",width:i,height:i,fill:r(t),"data-count":t.count,"data-date":T(t.date),onClick:()=>s(t),onMouseOver:()=>l(t)})),new Array(7-n.length).fill("block").map((t,e)=>S("rect",{class:"node",x:o,y:(n.length+e)*c+h,rx:"2",ry:"2",width:i,height:i,fill:"#fff",stroke:"#f4f5f5","stroke-width":"1px"})))}))}const p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Y({styles:n,values:t,size:e,space:i,padX:a,padY:o,customMonths:r,monthsPosition:s}){0<r.length&&r.length<p.length&&(r=[],console.info("`customMonths` should include 12 months."));const l=e+2*i,c=2*l,h=[];let d=o/2;return t.forEach((t,o)=>{t.forEach((t,e)=>{var n;0===e&&0===t.day&&(e=t.date.getMonth(),t=o*l+a+i,!(n=h.slice(-1).pop())||e!==n.month&&t-n.x>c)&&h.push({month:e,x:t})})}),"bottom"===s&&(d=7*l+o-i),S("g",null,h.map((t,e)=>S("text",{key:e,x:t.x,y:d,style:n.text},(0<r.length?r:p)[t.month])))}function $({styles:n,size:t,space:e,padX:o,padY:i,monthsPosition:a}){t+=2*e;let r=t/2;return"bottom"===a&&(r-=e+i/2),S("g",null,[{v:"M",y:i+ +t+r},{v:"W",y:i+3*t+r},{v:"F",y:i+5*t+r}].map((t,e)=>S("text",{key:e,x:o/2,y:t.y,style:n.text2},t.v)))}const z="12px",A='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif';function a({data:t=[],onClick:e=O,colorFun:n=function(t){return t.count?45<t.count?E[4]:30<t.count?E[3]:15<t.count?E[2]:E[1]:E[0]},startDate:o=function(){var t=j();return t.setFullYear(t.getFullYear()-1),new Date(864e5*(7-t.getDay())+t.getTime())}(),endDate:i=j(),size:a=12,space:r=1,padX:s=20,padY:l=20,monthsPosition:c="top",styleOptions:h={},showDayTitles:d=!0,showMonths:p=!0,customMonths:u=[],onHover:f=O}){var g=[],y=(M=o,i=i,M=Date.UTC(M.getFullYear(),M.getMonth(),M.getDate()),i=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate()),Math.floor((i-M)/C)),m=t.reduce((t,e)=>(t[e.date]=e.count,t),{});let x=0;for(let t=0;t<=y;t+=1){var v=new Date(o),b=(v.setDate(v.getDate()+t),v.getDay()),k=m[T(v)]||0;(0===b&&0!==t||0===t)&&(g.push([]),x+=1),g[x-1].push({count:k,date:v,day:b})}var w,P,i=a+2*r,M=x*i+2*s,t=7*i+l+10,i=`0 0 ${M} `+t,h=([{background:h="#fff",textColor:w="#959494",fontSize:D=z,fontFamily:P=A}]=[h],{background:h,text:w={fill:w,"font-size":D,"font-family":P,"dominant-baseline":"central"},text2:{...w,"text-anchor":"middle"}}),D={styles:h,values:g,size:a,space:r,colorFun:n,padX:s,padY:l,onClick:e,onHover:f,customMonths:u,monthsPosition:c};return S("svg",{width:M,height:t,viewBox:i},S("rect",{x:0,y:0,width:M,height:t,fill:h.background}),S(F,D),p&&S(Y,D),d&&S($,D))}const r=document;function s(t){var n,o,{tag:t,props:e,children:i}=t;const a=r.createElementNS("http://www.w3.org/2000/svg",t);return e&&(n=a,o=e,Object.keys(o).forEach(t=>{const e=o[t];"style"===t&&"object"==typeof e?Object.keys(e).forEach(t=>{n.style[t]=e[t]}):"onClick"===t?"function"==typeof e&&n.addEventListener("click",e):"onMouseOver"===t?"function"==typeof e&&n.addEventListener("mouseover",e):n.setAttribute(t,e)})),i.forEach(t=>{t&&a.appendChild("string"==typeof t?r.createTextNode(t):s(t))}),a}class e{constructor(t,e,n={}){this.ctx=function(t){const n="string"==typeof t?document.querySelector(t):t,o=n.getContext("2d"),i=(t=o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1,(window.devicePixelRatio||1)/t);return["width","height"].forEach(e=>{Object.defineProperty(o,e,{get(){return n[e]/i},set(t){n[e]=t*i,n.style[e]=t+"px",o.scale(i,i)},enumerable:!0,configurable:!0})}),n.addEventListener("click",t=>{var e;o.onClick&&(e=n.getBoundingClientRect(),o.onClick({x:(t.clientX-e.left)*i,y:(t.clientY-e.top)*i}))}),o}(t),this.data=e,this.options=n,this.render(),this.ctx.onClick=t=>this.render(t)}setData(t){this.data=t,this.render()}setOptions(t){this.options={...this.options,...t},this.render()}render(t){var{data:e,options:n}=this;!function e(t,n,o){var i,a,r,s,l,c,h,{tag:t,props:d,children:p}=t;"svg"===t&&({width:c,height:h}=d,n.width=c,n.height=h),"rect"===t&&({x:c,y:h,width:s,height:l,fill:i,stroke:a,onClick:r}=d,n.beginPath(),n.moveTo(c+2,h),n.lineTo(c+s-2,h),n.arc(c+s-2,h+2,2,1.5*Math.PI,2*Math.PI),n.lineTo(c+s,h+l-2),n.arc(c+s-2,h+l-2,2,0,.5*Math.PI),n.lineTo(c+2,h+l),n.arc(c+2,h+l-2,2,.5*Math.PI,Math.PI),n.lineTo(c,h+2),n.arc(c+2,h+2,2,Math.PI,1.5*Math.PI),o&&r&&n.isPointInPath(o.x,o.y)&&r(),n.closePath(),i&&(n.fillStyle=i,n.fill()),a)&&(n.strokeStyle=a,n.lineWidth=1,n.stroke()),"text"===t&&({x:s,y:l,style:c}=d,c&&(n.fillStyle=c.fill,h={start:"start",middle:"center",end:"end"},n.textBaseline={central:"middle",middle:"middle",hanging:"hanging",alphabetic:"alphabetic",ideographic:"ideographic"}[c["dominant-baseline"]]||"alphabetic",n.textAlign=h[c["text-anchor"]]||"start",n.font=`${c["font-weight"]||""} ${c["font-size"]} `+c["font-family"]),n.fillText(p.join(""),s,l)),p.forEach(t=>{"string"!=typeof t&&e(t,n,o)})}(S(a,o({data:e},n)),this.ctx,t)}}function l(t){const{tag:e,props:n,children:o}=t,i=[];return i.push("<"+e),Object.keys(n||{}).forEach(t=>{let e=n[t];"onClick"!==t&&("style"===t&&"object"==typeof e&&(e=Object.keys(e).map(t=>`${t}:${e[t]};`).join("")),i.push(` ${t}="${t=e,String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`))}),o&&o.length?(i.push(">"),o.forEach(t=>{"string"==typeof t?i.push(String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")):i.push(l(t))}),i.push(`</${e}>`)):i.push(" />"),i.join("")}t.CanvasGraph=e,t.SVGGraph=class{constructor(t,e,n={}){this.dom="string"==typeof t?document.querySelector(t):t,this.data=e,this.options=n,this.render()}setData(t){this.data=t,this.render()}setOptions(t){this.options={...this.options,...t},this.render()}render(){var{data:t,options:e}=this;this.tree&&this.dom.removeChild(this.tree),this.tree=s(S(a,o({data:t},e))),this.dom.appendChild(this.tree)}},t.StrGraph=class{constructor(t,e={}){this.data=t,this.options=e}setData(t){this.data=t}setOptions(t){this.options={...this.options,...t}}render(){var{data:t,options:e}=this;return l(S(a,o({data:t},e)))}},t.default=e,Object.defineProperty(t,"__esModule",{value:!0})});
